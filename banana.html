<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>No one is safe</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-family: Arial, sans-serif;
            color: white;
            background-color: black; /* Default background */
            overflow: hidden;
            position: relative;
        }
        .screen {
            display: none; /* All screens are hidden by default */
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            padding: 40px;
            box-sizing: border-box;
            flex-direction: column;
            position: absolute;
            top: 0;
            left: 0;
        }
        .visible {
            display: flex !important; /* Class to show a screen */
        }
        .hide-cursor {
            cursor: none;
        }

        /* --- Screen Specific Styles --- */
        #initialScreen { background-color: #0000FF; }
        #initialScreen .main-text { font-size: 48px; margin-bottom: 20px; }
        #initialScreen .sub-text { font-size: 24px; }

        #bsodScreen { background-color: #0000AA; }
        #bsodScreen .smiley { font-size: 60px; }
        #bsodScreen .large { font-size: 24px; margin-top: 20px; }
        #bsodScreen .code { font-size: 16px; color: #AAAAFF; margin-top: 20px; }
        
        #cmdScreen {
            background-color: black;
            color: #39FF14;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 16px;
            align-items: flex-start;
            justify-content: flex-start;
            text-align: left;
        }
        #cmdOutput { white-space: pre-wrap; margin: 0; }
        .cursor {
            background-color: #39FF14;
            animation: blink 1s step-start 0s infinite;
            display: inline-block;
            width: 10px;
            height: 18px;
        }
        @keyframes blink { 50% { opacity: 0; } }

        #potatoScreen { background-color: #3d2d1d; }
        #potatoScreen .potato-emoji { font-size: 150px; }
        #potatoScreen .loading-bar-container { width: 50%; max-width: 600px; height: 30px; background-color: #555; border: 2px solid #fff; border-radius: 15px; overflow: hidden; margin-top: 40px; }
        #potatoScreen .loading-bar { width: 0%; height: 100%; background-color: #f0e369; border-radius: 12px; }
        #potatoScreen .loading-animation { animation: load 10s linear forwards; }
        @keyframes load { from { width: 0%; } to { width: 100%; } }
        #potatoScreen #loadingText { margin-top: 20px; font-size: 24px; font-family: 'Courier New', Courier, monospace; }

        #videoScreen { background-color: black; padding: 0; }
        #videoPlayer { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body>

    <div class="screen" id="initialScreen">
        <div>
            <p class="main-text">No one is safe</p>
            <p class="sub-text">The Blue screen of doom has come for you</p>
        </div>
    </div>

    <div class="screen" id="bsodScreen">
        <div>
            <div class="smiley">:(</div>
            <div class="large">Your PC ran into a problem and needs to restart.</div>
            <div class="code">Stop code: CRITICAL_PROCESS_ERROR</div>
        </div>
    </div>

    <div class="screen" id="cmdScreen">
        <div>
            <pre id="cmdOutput"></pre><span class="cursor" id="cmdCursor"></span>
        </div>
    </div>

    <div class="screen" id="potatoScreen">
        <div class="potato-emoji">ðŸ¥”</div>
        <div class="loading-bar-container">
            <div class="loading-bar" id="progressBar"></div>
        </div>
        <p id="loadingText">potato computer loading</p>
    </div>
  
    <div class="screen" id="videoScreen">
        <video id="videoPlayer" src="video.mp4" playsinline></video>
    </div>

    <script>
        const screens = {
            initial: document.getElementById('initialScreen'),
            bsod: document.getElementById('bsodScreen'),
            cmd: document.getElementById('cmdScreen'),
            potato: document.getElementById('potatoScreen'),
            video: document.getElementById('videoScreen')
        };
        const videoPlayer = document.getElementById('videoPlayer');
        let isSequenceRunning = false;
        
        function showScreen(screenKey) {
            Object.values(screens).forEach(screen => screen.classList.remove('visible'));
            if (screens[screenKey]) {
                screens[screenKey].classList.add('visible');
            }
        }

        const sleep = ms => new Promise(resolve => {
            const timeout = setTimeout(resolve, ms);
            const checkCancel = setInterval(() => {
                if (!isSequenceRunning) {
                    clearTimeout(timeout);
                    clearInterval(checkCancel);
                    resolve(); // Resolve immediately if cancelled
                }
            }, 50);
        });

        async function typeCommands() {
            const cmdOutput = document.getElementById('cmdOutput');
            const cmdCursor = document.getElementById('cmdCursor');
            const commands = [
                '> HACKING SYSTEM...                [OK]',
                '> CHECKING ROOT VEGETABLE SYSTEM...',
                '> KERNEL: Starch Kernel 5.8-3',
                '> LOADING TUBER DRIVERS...         [OK]',
                '> EXECUTE C:\\SYSTEM\\POTATO.EXE -OVERRIDE',
                '> INITIATING POTATO COMPUTER...'
            ];
            cmdCursor.style.display = 'inline-block';
            for (const line of commands) {
                for (const char of line) {
                    if (!isSequenceRunning) return;
                    cmdOutput.innerHTML += char;
                    await sleep(20);
                }
                cmdOutput.innerHTML += '<br>';
                await sleep(200);
            }
            cmdCursor.style.display = 'none';
        }

        async function startSequence() {
            if (isSequenceRunning) return;
            isSequenceRunning = true;
            
            document.body.classList.add('hide-cursor');
            
            showScreen('initial');
            await sleep(4000);
            if (!isSequenceRunning) return;

            showScreen('bsod');
            await sleep(8000);
            if (!isSequenceRunning) return;

            showScreen('cmd');
            await typeCommands();
            if (!isSequenceRunning) return;
            await sleep(2000);
            if (!isSequenceRunning) return;
            
            showScreen('potato');
            const progressBar = document.getElementById('progressBar');
            progressBar.classList.add('loading-animation');
            await sleep(10000);
            if (!isSequenceRunning) return;

            showScreen('video');
            videoPlayer.play().catch(e => console.error("Video play failed:", e));
        }

        function resetSequence() {
            isSequenceRunning = false;
            showScreen(null);
            document.body.classList.remove('hide-cursor');
            document.getElementById('cmdOutput').innerHTML = '';
            const progressBar = document.getElementById('progressBar');
            progressBar.classList.remove('loading-animation');
            videoPlayer.pause();
            videoPlayer.currentTime = 0;
        }

        window.addEventListener('message', function(event) {
            if (event.data === 'startSequence') {
                startSequence();
            } else if (event.data === 'resetSequence') {
                resetSequence();
            }
        });

        videoPlayer.onended = () => {
            isSequenceRunning = false;
            window.parent.postMessage('sequenceFinished', '*');
        };
    </script>
</body>
</html>

